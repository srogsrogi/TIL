# 가상환경

- 컴퓨터 내에서 프로젝트별로 독립된 실행 환경을 관리할 수 있도록 만든 공간
- python 및 설치된 라이브러리를 관리



## venv | conda

- venv는 파이썬 내에 있는 모듈
  - 설치되어있는 파이썬 내부에서 실행되기 때문에 설치되어있지 않은 파이썬 버전으로 환경을 생성할 수 없음
  - python을 제외하고 패키지와 설정만 생성하면 되기 때문에 가벼움
- conda는 범용 가상환경 관리 도구
  - python 외에도 여러 프로그래밍 언어 기반으로 가상환경 생성 가능
  - 버전을 지정해주면 웹을 통해 해당 버전을 다운로드하여 가상환경을 만들어줌
  - 상대적으로 무겁지만 더 안정적이기 때문에 데이터 분석, 머신러닝, 대형 프로젝트에서 주로 사용



## venv

### venv 가상환경 생성 및 (비)활성화

- 생성

  - 현재 세션이 참조하는 버전으로 가상환경 생성

    `python -m venv myenv`

  - python 버전을 명시하여 가상환경 생성(해당 버전이 설치되어 있어야 함)

    `python3.11 -m venv myenv`

- 활성화

  - cmd

    `myenv\Scripts\activate`

  - linux / mac

    `source myenv/bin/activate`

  - git bash

    `source myenv/Scripts/activate`

- 비활성화

  - `deactivate`

- 삭제

  - 별도의 삭제 명령어는 없으므로 `deactivate`후 venv 디렉토리를 직접 삭제




## conda



### conda 가상환경 생성 및 (비)활성화

- 참고사항
  - anaconda 또는 miniconda가 사전에 설치되어 있어야 함
  - 기초적인 명령어들은 os나 터미널 종류 상관 없이 똑같이 동작
  - 세부 설정이나 일부 명령어는 조금씩 다를 수 있음
  - 일단 가장 무난한 cmd 기준으로 작성

- 생성

  `conda create -n myenv python=3.xx`

- 활성화

  `conda activate`

- 비활성화

  `conda deactivate`

  

##### ※ 저장소 채널 변경

- 패키지 저장소를 기본값인 `defaults`로 두는 경우 상업용 사용자에게 과금될 수 있음
- 다양한 패키지나 패키지의 최신 버전을 사용하고 싶은 경우 conda-forge를 사용하는게 유리함

- conda-forge로 채널 변경

​	`conda config --add channels conda-forge`

- 채널 우선순위 설정

​	`conda config --set channel_priority strict`



## 패키지 관리

- 설치

  `pip install <패키지명>`

  `conda install <패키지명>`

  - conda install은 패키지 의존성을 계산한 후 설치해주기 때문에 조금 더 안정적으로 작동
  - conda 가상환경을 사용하는 경우 `conda install`을 우선적으로 사용하고, conda에 없는 패키지만 `pip install`로 설치하는 것을 권장

- 설치된 패키지 백업

  `pip freeze > requirements.txt`

- conda 환경 백업

  `conda env export > environment.yml`

- 다른 가상환경에서 패키지설치

  `pip install -r requirements.txt`

- conda 환경 설치

  `conda env create -f environment.yml`

##### **※ 주의사항**

- venv 디렉토리는 git이 추적하지 않도록 `.gitignore`에 추가할 것

- pip freeze를 하는 경우 `win`이 포함된 윈도우 전용 기본 패키지들이 함께 설치되어 호환성 문제를 일으킬 수 있음

  - `--from-history` 옵션으로 직접 설치한 패키지만 requirements.txt에 추가할 수 있음

- 개별 패키지가 업데이트되는 경우 의존성 문제가 생길 수 있어 버전을 명시하여 저장하는 것을 권장

  

## 감상

- conda 가상환경은 많이 써봤는데, venv를 안 써봐서 venv를 다뤄봄
- 앞으로 ai 많이 쓰지 않는 가벼운 프로젝트나 테스트용 환경으로는 venv를 쓰게 될 듯
- 옆사람 알려줘야 해서 원래 아는 내용도 포함해서 평소보다 조금 더 자세하게 TIL 씀..

- 맨날 쓰는 명령어만 쓰다 보니까 `--from-history` 옵션이나 env.yml파일 만드는 건 몰랐음. 남이 알려준 걸 그대로 가져다 쓰는 것과 알기 위해 스스로 공부하는 것의 차이를 알 수 있는 대목